(function(t){function e(e){for(var a,c,r=e[0],s=e[1],l=e[2],p=0,d=[];p<r.length;p++)c=r[p],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&d.push(i[c][0]),i[c]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,r=1;r<n.length;r++){var s=n[r];0!==i[s]&&(a=!1)}a&&(o.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},i={app:0},o=[];function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=s;o.push([3,"chunk-vendors"]),n()})({0:function(t,e){},"0ddd":function(t,e,n){"use strict";n("cf08")},"0fd4":function(t,e,n){"use strict";n("2c23")},1:function(t,e){},2:function(t,e){},2395:function(t,e,n){},"2c23":function(t,e,n){},3:function(t,e,n){t.exports=n("56d7")},4:function(t,e){},"47e9":function(t,e,n){"use strict";n("6d44")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("keep-alive",[n(t.currentTabComponent,{tag:"component"})],1)],1)},o=[],c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},r=[],s={},l=s,u=n("2877"),p=Object(u["a"])(l,c,r,!1,null,null,null),d=p.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"nav_bar"}),n("div",{staticClass:"main_container"},[n("div",{staticClass:"select_map_container"},[n("Select"),n("Map")],1),n("div",{staticClass:"stat_control_container"},[n("GlobalStat")],1)])])},h=[],v=n("5530"),m=(n("d3b7"),n("d81d"),n("a9e3"),n("b64b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"map",attrs:{id:"hex-map"}},[n("VueDeckgl",{staticClass:"deck-map",attrs:{layers:t.layers,viewState:t.viewState,width:"70vw",height:"85vh"},on:{click:t.handleClick,"view-state-change":t.handleViewStateChange}}),n("div",{ref:"map",attrs:{id:"map"}}),n("el-popover",{staticClass:"control-panel",attrs:{placement:"right",width:"220",trigger:"click"}},[n("div",{staticClass:"block"},[n("span",{staticClass:"demonstration"},[t._v("Coverage")]),n("el-slider",{staticStyle:{width:"200px"},attrs:{width:300,min:0,max:1,step:.01},model:{value:t.coverage,callback:function(e){t.coverage=e},expression:"coverage"}})],1),n("div",{staticClass:"block"},[n("span",{staticClass:"demonstration"},[t._v("Opacity")]),n("el-slider",{staticStyle:{width:"200px"},attrs:{width:300,min:0,max:1,step:.01},model:{value:t.opacity,callback:function(e){t.opacity=e},expression:"opacity"}})],1),n("div",[n("label",{attrs:{for:"color"}},[t._v("Color Inversion")]),n("input",{attrs:{id:"color",type:"checkbox",name:"color"},on:{change:t.update_layers}}),n("span",{attrs:{id:"color-value"}})]),n("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("Control Panel")])],1)],1)}),y=[],b=n("ade3"),g=(n("6062"),n("3ca3"),n("ddb0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"deckgl-container",attrs:{width:t.width,height:t.height}},[t._t("default"),n("canvas",{ref:"canvas",attrs:{id:"deck-canvas"},on:{contextmenu:t.handleContextMenu}}),t._t("foreground")],2)}),x=[],k=(n("99af"),n("b680"),n("9b26")),_=n("5a2b"),w={name:"VueDeckgl",props:{width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},layers:{type:Array,default:function(){return[]}},viewState:{type:Object,default:function(){return{latitude:40.6971494,longitude:-74.2598655,zoom:12,pitch:0}},required:!0},cursor:{type:String,default:"default"},controller:{type:[Boolean,Object],default:!0},effects:{type:Array,default:function(){return[]}},disableContextMenu:{type:Boolean,default:!1}},data:function(){return{}},methods:{initializeDeck:function(t,e){var n=this;return new k["a"]({canvas:this.$refs.canvas,width:this.width,height:this.height,style:{"!position":"relative"},viewState:t,controller:this.controller,onViewStateChange:function(t){var e=t.viewState;n.deck.setProps({viewState:e}),n.$emit("view-state-change",e)},onClick:function(t,e){n.$emit("click",{info:t,event:e})},onDrag:function(t,e){n.$emit("drag",{info:t,event:e})},onDragStart:function(t,e){n.$emit("onDragStart",{info:t,event:e})},onDragEnd:function(t,e){n.$emit("onDragEnd",{info:t,event:e})},getCursor:function(t){var e=t.isDragging;return e?"grabbing":n.cursor||"grab"},layers:e,effects:this.effects,getTooltip:function(t){try{if("heatmap"===t.layer.id){var e=t.object;return e&&{text:"Total Population: ".concat(e.totpop," \n White: ").concat((100*e.white/e.totpop).toFixed(2),"% \n Black: ").concat((100*e.black/e.totpop).toFixed(2),"% \n Native American: ").concat((100*e.hisp/e.totpop).toFixed(2),"% \n Asian: ").concat((100*e.asian/e.totpop).toFixed(2),"% \n Num of Census Blocks: ").concat(e.count),style:{position:"relative",fontSize:"12px",color:"#000",backgroundColor:"#efe",width:"200px",height:"100px",overflow:"scroll",marginLeft:"20px",marginTop:"20px",opacity:.75}}}return"Scatter Layer"}catch(n){return}}})},handleContextMenu:function(t){this.disableContextMenu&&t.preventDefault()}},watch:{layers:function(t){this.deck.setProps({layers:t})},viewState:function(t){this.deck.setProps({viewState:Object(v["a"])(Object(v["a"])({},t),{},{transitionInterpolator:new _["a"]})})},effects:function(t){this.deck.setProps({effects:t})}},created:function(){this.deck=null},mounted:function(){this.deck=this.initializeDeck(this.viewState,this.layers)},destroyed:function(){this.deck.finalize()}},C=w,S=(n("0ddd"),Object(u["a"])(C,g,x,!1,null,"1f9e9fd8",null)),O=S.exports,j=n("fbbb"),P=n("9043"),D=n("3614"),I=n("e192"),E=n.n(I),$=n("2f62"),L="mapbox://styles/mapbox/streets-v11",M={name:"Map",components:{VueDeckgl:O},data:function(){return{ICON_MAPPING:{marker:{x:0,y:0,width:128,height:128,mask:!0}},data:null,viewState:{longitude:-84.388,latitude:33.749,zoom:11,minZoom:3,maxZoom:17,pitch:20},layers:[],hexagonLayer:null,scatterLayer:null,map:null,coverage:.9,opacity:.2,hex_set:new Set}},computed:Object($["b"])({cityData:function(t){return t.cityData},pois:function(t){return t.pois},clickEvent:function(t){return t.clickEvent}}),watch:{coverage:function(t,e){this.update_layers()},opacity:function(t,e){this.update_layers()},pois:{handler:function(t){this.update_layers("scatter")},deep:!0},cityData:{handler:function(t){this.update_layers("hex")},deep:!0}},methods:{notify:function(t,e,n){n?this.$notify({title:t,message:e,duration:4500,type:"success"}):this.$notify.error({title:t,message:e,duration:4500})},handleClickChain:function(t){0===this.clickEvent?t.info.layer.id:this.handleAddPOI(t)},handleAddPOI:function(t){1===this.clickEvent?"heatmap"===t.info.layer.id?this.notify("Add POI Succeed","It may take a while to recalculate",!0):this.notify("Add POI Failed","Cannot add POI on a existing POI",!1):this.handleRemovePOI(t)},handleRemovePOI:function(t){if(2!==this.clickEvent)throw new Error("Invalid clickEvent");"heatmap"===t.info.layer.id?this.notify("Remove POI Failed","Cannot remove an unexisting POI",!1):this.notify("Remove POI Succeed","It may take a while to recalculate",!0)},handleClick:function(t){this.handleClickChain(t)},handleViewStateChange:function(t){this.viewState=Object(v["a"])({},t),null!==this.map&&this.map.jumpTo({center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch})},handleDemographic:function(t){},handleCatchment:function(t){},prepareCityData:function(){},handleHexSet:function(t){var e=t.map((function(t){return t.hex_id})),n=new Set(e);this.hex_set=n},createHexagonLayer:function(){var t=this,e=this.cityData,n=new D["a"](Object(b["a"])({id:"heatmap",data:e,elevationRange:[0,0],opacity:.2,wireframe:!1,filled:!0,extruded:!1,pickable:!0,getHexagon:function(t){return t.hex},getFillColor:function(e){return t.hex_set.has(e.hex)?[0,255,0]:[255,0,0]},updateTriggers:{getFillColor:document.getElementById("color").checked},coverage:this.coverage},"opacity",this.opacity));return n||null},createScatterLayer:function(){var t=new j["a"]({id:"scatter-layer",data:this.pois,opacity:.8,filled:!0,radiusMinPixels:4,radiusMaxPixels:4,getRadius:function(t){return 4},getPosition:function(t){return[t[0],t[1]]},getFillColor:function(t){return[0,128,255]},pickable:!0,onHover:function(t){t.object,t.x,t.y}});return t||null},createIconLayer:function(){var t=new P["a"]({id:"icon-layer",data:this.pois,pickable:!0,iconAtlas:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/icon-atlas.png",iconMapping:this.ICON_MAPPING,getIcon:function(t){return"marker"},sizeScale:9,getPosition:function(t){return[t[0],t[1]]},getSize:function(t){return 1},getColor:function(t){return[0,128,255]}});return t||null},update_layers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";this.prepareCityData(),this.handleHexSet([]),"all"!==t&&"hex"!==t||(this.hexagonLayer=this.createHexagonLayer()),"all"!==t&&"scatter"!==t||(this.scatterLayer=this.createScatterLayer()),this.layers=[this.hexagonLayer,this.scatterLayer]}},mounted:function(){this.map=new E.a.Map({accessToken:"pk.eyJ1Ijoic2VuZGF5byIsImEiOiJjams4MjdqOXAyZ2VrM3BydDRzeTR4cjBsIn0.Hk0FF4BvDNJZeDAZZiPlcg",container:this.$refs.map,style:L,interactive:!0,center:[this.viewState.longitude,this.viewState.latitude],zoom:this.viewState.zoom,bearing:0,pitch:this.viewState.pitch})}},T=M,N=(n("bc29"),Object(u["a"])(T,m,y,!1,null,"815deb3e",null)),A=N.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"globa_stat"},[n("h1",[t._v(" This is the Global Stat ")]),n("div",{staticClass:"block"},[n("el-carousel",{attrs:{trigger:"click",height:"35vh",autoplay:!1}},t._l(t.items,(function(e){return n("el-carousel-item",{key:e},[n("h2",{staticClass:"title"},[t._v(t._s(e))])])})),1)],1)])},z=[],H={name:"GlobalStat",data:function(){return{items:["Housing","Income","Labor","Poverty","Unemployment","Violence"]}},methods:{render:function(t){console.log(t)}}},R=H,V=(n("47e9"),Object(u["a"])(R,F,z,!1,null,"597abfca",null)),G=V.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"city_select"},[n("el-select",{attrs:{placeholder:"Select City"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.cityList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1),n("el-select",{staticStyle:{"margin-left":"20px"},attrs:{placeholder:"Select POI Type"},model:{value:t.poi_type,callback:function(e){t.poi_type=e},expression:"poi_type"}},t._l(t.pois,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1),n("el-radio-group",{staticStyle:{"margin-left":"20px"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[n("el-radio",{attrs:{label:0}},[t._v("Default")]),n("el-radio",{attrs:{label:1}},[t._v("Add")]),n("el-radio",{attrs:{label:2}},[t._v("Delete")])],1)],1)},Z=[],J=n("262e"),U=n("2caf"),q=n("d4ec"),X=n("bee2"),W=(n("e9c4"),function(){function t(){Object(q["a"])(this,t),this.ajax=new XMLHttpRequest}return Object(X["a"])(t,[{key:"get",value:function(t,e){var n=this;this.ajax.open("GET",t),this.ajax.onreadystatechange=function(){4===n.ajax.readyState&&200===n.ajax.status&&e(n.ajax.responseText)},this.ajax.send()}},{key:"post",value:function(t,e,n){var a=this;this.ajax.open("POST",t),this.ajax.setRequestHeader("Content-Type","application/json"),this.ajax.onreadystatechange=function(){4===a.ajax.readyState&&200===a.ajax.status&&n(a.ajax.responseText)},this.ajax.send(JSON.stringify(e))}}]),t}()),K=function(t){Object(J["a"])(n,t);var e=Object(U["a"])(n);function n(){return Object(q["a"])(this,n),e.call(this)}return Object(X["a"])(n,[{key:"init",value:function(t){this.get("/init",(function(e){t(e)}))}},{key:"configUpdate",value:function(t,e){this.post("/updateConfig",t,(function(t){e(t)}))}},{key:"poiUpdate",value:function(t,e){this.post("/updatePoi",t,(function(t){e(t)}))}}]),n}(W),Q=K,Y={name:"Select",data:function(){return{pois:[{value:"grocery",label:"Grocery Stores"},{value:"vaccination",label:"Vaccination Centers"},{value:"schools",label:"Schools"},{value:"hospitals",label:"Hospitals"},{value:"polling",label:"Polling Places"}],value:"",poi_type:"",radio:0}},methods:{update_callback:function(t){this.$store.commit("setCityData",t)}},computed:Object($["b"])({cityList:function(t){return t.cityList},config:function(t){return t.config}}),watch:{value:function(t){this.$store.commit("setConfigCity",t);var e=new Q;e.configUpdate(this.config,this.update_callback)},poi_type:function(t){this.$store.commit("setConfigPOIType",t);var e=new Q;e.configUpdate(this.config,this.update_callback)},radio:function(t){this.$store.commit("setClickEvent",t)}}},tt=Y,et=(n("f9b4"),Object(u["a"])(tt,B,Z,!1,null,"d3eea668",null)),nt=et.exports,at=n("5698"),it=n("f75e"),ot={name:"Main",components:{Map:A,GlobalStat:G,Select:nt},methods:{dummy_render:function(t){var e=this;new Promise((function(t,n){at["a"]("./dummy_data.csv").then((function(t){var n=t.map((function(t){return[Number(t.stop_lon),Number(t.stop_lat)]}));e.$store.commit("setPois",n)})),at["a"]("lat_lon_to_census_data.csv").then((function(t){var n=t.map((function(t){return{hex:it["c"](Number(t.lat),Number(t.lon),9),lon:Number(t.lon),lat:Number(t.lat),totpop:Number(t.pop_total),white:Number(t.pop_white),black:Number(t.pop_black),hisp:Number(t.pop_indian_alaskan),asian:Number(t.pop_asian)}}));n=n.reduce((function(t,e){return t[e.hex]?(t[e.hex].totpop+=e.totpop,t[e.hex].white+=e.white,t[e.hex].black+=e.black,t[e.hex].hisp+=e.hisp,t[e.hex].asian+=e.asian,t[e.hex].count+=1,t):(t[e.hex]=Object(v["a"])(Object(v["a"])({},e),{},{count:1}),t)}),{});var a=Object.keys(n).map((function(t){var e=n[t];return{hex:e.hex,totpop:e.totpop,count:e.count,white:e.white,black:e.black,hisp:e.hisp,asian:e.asian}}));e.$store.commit("setCityData",a)}))}))},render:function(t){var e=[{value:12,label:"Atlanta"}];this.$store.commit("setCityData",t.cityData),this.$store.commit("setCityList",e)},init:function(){this.FEProxy.init(this.dummy_render)}},mounted:function(){this.FEProxy=new Q,this.init()}},ct=ot,rt=(n("0fd4"),Object(u["a"])(ct,f,h,!1,null,"7da97fe2",null)),st=rt.exports,lt={name:"App",components:{Compare:d,Main:st},data:function(){return{currentPage:"Main"}},computed:{currentTabComponent:function(){return"main"===this.currentPage.toLowerCase()?st:d}}},ut=lt,pt=(n("7c55"),Object(u["a"])(ut,i,o,!1,null,null,null)),dt=pt.exports;a["default"].use($["a"]);var ft=new $["a"].Store({state:{config:{},pois:null,cityData:{},cityList:{},clickEvent:0},mutations:{setClickEvent:function(t,e){t.clickEvent=e},setPois:function(t,e){t.pois=e},setConfig:function(t,e){t.config=e},setCityData:function(t,e){t.cityData=e},setCityList:function(t,e){t.cityList=e},setConfigPOIType:function(t,e){t.config.poiType=e},setConfigCity:function(t,e){t.config.city=e}},actions:{},modules:{}}),ht=n("5c96"),vt=n.n(ht);n("0fae");a["default"].config.productionTip=!1,a["default"].use(vt.a),new a["default"]({store:ft,render:function(t){return t(dt)}}).$mount("#app")},"621d":function(t,e,n){},"6d44":function(t,e,n){},"7c55":function(t,e,n){"use strict";n("2395")},b9e8:function(t,e,n){},bc29:function(t,e,n){"use strict";n("621d")},cf08:function(t,e,n){},f9b4:function(t,e,n){"use strict";n("b9e8")}});
//# sourceMappingURL=app.381fdfa3.js.map